package ColumnBasedGame;

import java.util.ArrayList;

import javafx.concurrent.Service;
import javafx.concurrent.Task;
import javafx.scene.shape.Circle;

public class CheckService {

	private static ArrayList<Circle> circles = new ArrayList<Circle>();
	private static ArrayList<Double> fallDepths = new ArrayList<Double>();
	private static double rowHeight = 0;
	private static Service<Void> fall;
	private static boolean pause = false;

	public CheckService() {
		fall = new Service<Void>() {
			@Override
			protected Task<Void> createTask() {
				return new Task<Void>() {
					protected Void call() throws Exception {
						while (!pause) {
							if (circles.size() > 0) {
								for (int i = 0; i < circles.size(); i++) {
									Circle c = circles.get(i);
									if (c.getCenterY()+c.getRadius()+1 < fallDepths.get(i)) {
										c.setCenterY(c.getCenterY() + c.getRadius()+1);
									} else {
										removeCircle(i);
										System.out.println("Removed a circle: " + circles.size() + " elements in list.");
									}
								}
								Thread.sleep(30);
							} 
						}
						return null;
					}
				};
			}
		};
	}

	public static void addCircle(GameColumn column, Circle c) {
		if (rowHeight == 0) {
			rowHeight = column.getRowHeight();
		}
		circles.add(c);
		fallDepths.add((2*column.getRowHeight()) + column.getFallDepth()*column.getRowHeight());
		fall.restart();
	}

	public static void removeCircle(int i) {
		circles.remove(i);
		fallDepths.remove(i);
	}

	public static void pause() {
		pause = !pause;
	}

}
